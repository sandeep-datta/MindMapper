<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="lib/jquery.js"></script>
	<script type="text/javascript" src="lib/textile.js"></script>
	<script type="text/javascript" src="lib/html2canvas.js"></script>
</head>

<body>
<p>
	<div id="target" style="border:2px solid black;" width="800" height="200"></div>
</p>
<p>
	<div id="temp" style="border:2px solid black;" width="800" height="200"></div>
</p>
<p>
	<textarea id="editor" style="border:2px solid black;" width="800" height="200"></textarea>
</p>
<script>

$(document).ready(function () {
    init();
});

function init() {
    var $content = $('#editor'); // my textarea
    var $target = $('#target'); // the preview div
    var $temp = $('#temp');

    // use a simple timer to check if the textarea content has changed
    var value = $content.val();

    setInterval(function () {
        var newValue = $content.val();
        if (value != newValue) {
            value = newValue;
            $temp.empty();
            $temp.append($.parseHTML(textile.convert(newValue)));
            html2canvas($temp, {
	            	onrendered: function(canvas) {
	            		$target.empty();
	            		$target.append(canvas);
	            	}
            	}
            ); // convert the textile to html
        }
    }, 500);
};
</script>
</body>
</html>